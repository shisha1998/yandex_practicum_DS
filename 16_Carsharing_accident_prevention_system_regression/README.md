# Разработка системы предупреждения аварий на каршеринге


## Данные

В наличии были следующие данные с сервиса каршеринга: 
- Направление движения 
- Является ли место происшествие перекрёстком
- Погода
- Тип дороги 
- Серьёзность происшествия
- Количество участников
- Основной фактор аварии
- Категория нарушения
- Тип аварии
- Дополнительные участники ДТП 
- Состояние дороги
- Дорожное состояние
- Освещение
- Устройство управления
- Дата и время происшествия
- Тип участника происшествия 
- Виновность участника
- Сумма страховки
- Трезвость участника
- Состояние участника
- Наличие телефона в автомобиле
- Тип кузова
- Тип КПП
- Возраст автомобиля

## Задача

Построить систему предупреждения об аварии клиентам каршеринга

## Используемые библиотеки
*pandas*, *numpy*, *sklearn*, *catboost*, *sql*, *phik*, *matplotlib*, *seaborn*

## Итоги исследования

Были обучены модели LogisticRegression(), RandomForestClassifier() и CatBoostClassifier() при использования поиска по сетке при помощи GridSearchCV().

Наилучшей является модель CatBoostClassifier(), она имеет наилучшую метрику f1, которая равняется 0,665 на трейне при кросс-валидации и 0.665 на тесте.

Была построена матрица ошибок и кривая зависимости полноты и точности:
- Прогноз совпал с реальностью для 0 для 4895 значения, а для 1 - для 3896 значений. 
- Модель предсказала 0, а на самом деле должно быть 1 для 2826 значений.
- Модель предсказала 1, а на самом деле должно быть 0 для 1756 значений.

Наиболее важные признаки для модели:
- сумма страховки
- трезвость водителя
- тип трансмиссии
- наличие устройства помощи водителю
- возраст автомобиля

Было проведено исследование одного из важных факторов, влияющих на аварийность:
- Виновниками аварии чаще становятся владельцы машин возраста 2-4 года. Для того, чтобы снизить уровень аварийности можно предложить проходить владельцам таких автомобилей дополнительную проверку на знание ПДД перед посадкой, а также можно повысить сумму штрафа для них при попадании в ДТП.
 
Чтобы улучшить модель можно:
- уточнить данные водителя: опыт вождения, пол, возраст, участие в ДТП в прошлом и т.д.
- уточнить данные предполагаемого маршрута у водителя для диагностирования опасных дорожных участков
- сигнализировать водителю о факторах, влияющих на условия вождения: плохие погодные условия, плохие дорожные условия, освещенность
- поставаить дополнительное оборудование (камеры, анализаторы алкольного опьянения и т.д) для диагностирования состояния водителя
