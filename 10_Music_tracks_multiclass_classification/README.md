# Классификация музыкальных произведений по жанрам


## Данные

В наличии были следующие данные музыкального сервиса:
- уникальный идентификатор трека
- название трека
- акустичность
- танцевальность
- продолжительность в милисекундах
- энергичность
- инструментальность
- базовый ключ (нота) произведения
- привлекательность
- loudness - громкость
- указывает на модальность (мажорную или минорную) трека
- выразительность
- темп
- дата загрузки в сервис
- привлекательность произведения для пользователей сервиса
- музыкальный жанр

## Задача

Разработать модель, позволяющую классифицировать музыкальные произведения по жанрам.

## Используемые библиотеки
*pandas*, *numpy*, *sklearn*, *catboost*, *phik*, *matplotlib*, *seaborn* 

## Итоги исследования

Был создан конвейер при помощи pipeline и column_transformer, включающий в себя:
- Для численных столбцов заполнение пропусков при помощи IterativeImputer() и масштабирование данных при помощи StandardScaler().
- Для категориальных столбцов заполнение пропусков при помощи SimpleImputer() по самому частому значению и кодирование данных при помощи OneHotEncoder().
- Функцию детектирования аномалий при помощи IsolationForest()

Были обучены следующие модели с подбором гиперпараметров по сетке:
- RandomForestClassifier();
- CatBoostClassifier(); 
- SVC().

Наилучшей моделью на трейне является CatBoostClassifier() и имеет наилучшую метрику f1_micro, которая равняется 0,483. Итоговая оценка качества для модели CatBoostClassifier() на платформе kaggle равняется 0,482.

Был проведен анализ важности признаков наилучшей модели:
1. инструментальность
2. танцевальность
3. выразительность
4. акустичность
5. привлекательность произведения для пользователей сервиса

Анализ для этих признаков:
1. Инструменатальность распределена от 0 до 1, но подавляющее большинство значений близки к 0. Жанры, обладающие интсрументальностью - классика, электронная музыка и джаз.
2. Танцевальность распределена нормально от 0 до 1, чаще всего встречаются значения близкие к 0,58. Жанры, обладающие большей танцевальностью - хип-хоп и рэп, а меньшей - классика и аниме.
3. Выразительность распределена от 0 до 1, чаще всего встречаются значения близкие к нулю. Жанры, обладающие большей выразительностью - хип-хоп и рэп, а меньшей - кантри и рок.
4. Акустичность распределена от 0 до 1, чаще всего встречаются значения близкие к нулю. Жанры, обладающие большей акустичностью - классика и джаз, а меньшей акустичностью - электронная музыка и альтернатива.
5. Привлекательность для пользователя распределена от 0 до 1, чаще всего встречаются значения близкие к 0,38. Жанры, обладающие большей привлекательностью - блюз и кантри, а меньшей - классика и электроника.
6. Музыкальные жанры распределены не совсем равномерно. Чаще всего встречаются - блюз, реже всего хип-хоп.