# Поиск по изображению


## Данные

В наличии были следующие данные: 
- изображения для тренировки и теста модели
- данные по соответствию изображения и описания, полученные с помощью краудсорсинга
- данные по соответствию изображения и описания
- информация, необходимая для тестирования: текст запроса и релевантное изображение

## Задача

Разработать простой поиск картинок по запросу.

## Используемые библиотеки
*pandas*, *numpy*, *sklearn*, *catboost*, *nltk*, *torch*, *transformers*,  *matplotlib*, *seaborn*

## Итоги исследования

Были изучены оценки экспертов и оценки с краудсорсинга:
- Эксперты чаще всего оценивали соответствие текста изображению как "изображение и запрос совершенно не соответствуют друг другу" и "запрос содержит элементы описания изображения, но в целом запрос тексту не соответствует".
- Оценки с краудсоринга чаще всего показывают, что текст и изображение не соотвествуют друг другу, как и в случае оценок экспертов.

Был подготовлен список стоп-слов, наличие которых недопустимо в датасете. Из датасета были удалены строки, в которых содержались стоп-слова.

Была проведена векторизация изображений обучающего датасета при помощи
предварительно натренированной на датасете ImageNet ResNet-18, у которой были исключены полносвязные слои, которые отвечают за конечное предсказание.

Была проведена векторизация текста обучающего датасета при помощи DistilBERT.

Были объединены векторы изображений и векторы текстов в один вектор признаков, была подготовлена целевая переменная.

Данные были разбиты на обучающую и тестовую выборки при помощи GroupShuffleSplit и отмасштабированы при помощи StandardScaler.

Были обучены следующие модели и проверено ик качество на валидационной выборке: LinearRegression(), CatBoostRegressor(), полносвязная нейронная сеть. Метрика для оценки качества была выбрана RMSE, так как она подходит для задачи регрессии и позволяет учесть все отклонения модели от истинных значений.

Было проведено тестирование : была написана функция, которая на вход принимает текстовый запрос и на выход выдает наиболее релевантное изображение. Для получения тестовых предсказаний использовалась нейронная сеть - на практике она лучше подбирает изображения к тексту, чем CatBoostRegressor, метрика которого на трейне оказалась больше. Используемая нейронная сеть включает в себя 5 слоев и Batch Normalization.

Часть изображений частично соотвествует описанию (изображение с собакой и текст про собаку; мужчина на велосипеде - текст про мужчину на велосипеде), но результат тестирования тяжело назвать удовлетворительным, так как часть изображений полностью не соответствуют своему описанию.

Для улучшения качества могут быть приняты следующие меры:
- Необходимо использовать больше данных для обучения.
- Данные должны быть качественно оценены на соответствие описанию.
- Изображения и запросы для обучения модели должны быть адекватными.
- Можно лучше подобрать гиперпарметры используемых моделей или попробовать использовать другие модели.
- Попробовать другие методы векторизации текста и изображений.
- Попробовать другие методы агрегировнаия оценок экспертов и оценок с краудсорсинга.